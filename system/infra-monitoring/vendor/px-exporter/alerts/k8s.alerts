groups:
- name: alerts for PX kubernetes resources
  rules:
  - alert: PXPodNotReady
    expr: sum
      by(pod) ((kube_pod_info{namespace="px"} * on(node) group_left() sum by(node) (kube_node_status_condition{condition="Ready",status="true"})
      * on(pod) group_left() sum by(pod) (kube_pod_status_phase{namespace="px", phase="Running"})
      == 1) * on(pod) group_left() sum by(pod) (kube_pod_status_ready{namespace="px", condition="true"}))
      == 0
    for: 2h
    labels:
      severity: info
      tier: net
      service: px
      context: px
    annotations:
      description: "TEST ALERT - PLEASE IGNORE - The pod px /{{ $lables.pod }} is not ready for more than 2h"
      summary: "TEST ALERT - PLEASE IGNORE - Pod not ready for a long time"