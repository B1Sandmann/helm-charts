{{ if .Values.enabled }}

kind: Deployment
apiVersion: extensions/v1beta1

metadata:
  name: ping-exporter
  labels:
    app: ping-exporter
    release: "{{$.Release.Name}}"

spec:
  replicas: 1
  template:
    metadata:
      labels:
        name: ping-exporter
        app: ping-exporter
    spec:
      volumes:
        - name: ping-exporter
          configMap:
            name: ping-exporter
      containers:
        - name: ping-exporter
          image: czerwonk/ping_exporter:latest
          imagePullPolicy: Always
          env:
            - name: CONFIG_FILE
              value: /config.yaml
          volumeMounts:
            - name: ping-exporter
              mountPath: /
{{ end }}