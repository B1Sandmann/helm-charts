{{ if .Values.enabled }}

apiVersion: v1
kind: ConfigMap

metadata:
  name: ping-exporter
  labels:
    app: ping-exporter
    release: "{{$.Release.Name}}"

data:
  config.yaml: |
    ping:
      interval: {{- .Values.pingInterval }}
      timeout: {{- .Values.pingTimeout }}
      history-size: {{- .Values.pingHistorySize }}
      payload-size: {{- .Values.pingPayloadSize }}
    targets:
    {{- range $i, $target := .Values.static_ping_targets }}
      - $target.target
    {{- end }}

  {{ end -}}